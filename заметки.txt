1) Пользлватель вводит логин и пароль. [Авторизация происходит по JWT, стандартным образом]
2) Сам пользователь может зайти в настройки своего профиля и включить двухфакторную авторизацию.
3) Двухфакторная авторизация принимает логин и пароль пользователя, если такой существует в базе, то генерирует временный acces токен с временм жизни 30 минут.
4) Пользователь при входе получает токен с коротким временем жизни и получает письмо на почту, которую указал в логине.
5) Пользователь должен ввести полученный код на сайте для прохождения авторизации.
6) Сгенерировать acces токен как в пункте 1.